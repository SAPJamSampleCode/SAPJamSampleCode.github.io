/*!
 * SAP UI development toolkit for HTML5 (SAPUI5/OpenUI5)
 * (c) Copyright 2009-2014 SAP SE or an SAP affiliate company. 
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare("sap.ui.unified.Calendar");jQuery.sap.require("sap.ui.unified.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.unified.Calendar",{metadata:{publicMethods:["focusDate"],library:"sap.ui.unified",properties:{"intervalSelection":{type:"boolean",group:"Misc",defaultValue:false},"singleSelection":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"selectedDates":{type:"sap.ui.unified.DateRange",multiple:true,singularName:"selectedDate"},"specialDates":{type:"sap.ui.unified.DateTypeRange",multiple:true,singularName:"specialDate"}},events:{"select":{},"cancel":{}}}});sap.ui.unified.Calendar.M_EVENTS={'select':'select','cancel':'cancel'};jQuery.sap.require("sap.ui.core.LocaleData");jQuery.sap.require("sap.ui.core.delegate.ItemNavigation");jQuery.sap.require("sap.ui.model.type.Date");(function(){sap.ui.unified.Calendar.prototype.init=function(){this._mouseMoveProxy=jQuery.proxy(this._handleMouseMove,this);this._iMode=0;this._oFormatYyyymmdd=sap.ui.core.format.DateFormat.getInstance({pattern:"yyyyMMdd"});this._oMinDate=new Date(Date.UTC(1,0,1));this._oMinDate.setUTCFullYear(1);this._oMaxDate=new Date(Date.UTC(9999,11,31))};sap.ui.unified.Calendar.prototype.exit=function(){if(this._sRenderMonth){jQuery.sap.clearDelayedCall(this._sRenderMonth)}};sap.ui.unified.Calendar.prototype.onAfterRendering=function(){var i=this;d(i);r(i);t(i,this._getFocusedDate(),true)};sap.ui.unified.Calendar.prototype.invalidate=function(O){if(!O||!(O instanceof sap.ui.unified.DateRange)){sap.ui.core.Control.prototype.invalidate.apply(this,arguments)}else if(this.getDomRef()&&this._iMode==0&&!this._sRenderMonth){var i=this;this._sRenderMonth=jQuery.sap.delayedCall(0,this,e,[i])}};sap.ui.unified.Calendar.prototype.setLocale=function(L){if(this._sLocale!=L){this._sLocale=L;this._oLocaleData=undefined;this.invalidate()}return this};sap.ui.unified.Calendar.prototype.getLocale=function(){if(!this._sLocale){this._sLocale=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().toString()}return this._sLocale};sap.ui.unified.Calendar.prototype._getFocusedDate=function(){if(!this._oFocusedDate){var i=this;j(i)}return this._oFocusedDate};sap.ui.unified.Calendar.prototype._setFocusedDate=function(D){this._oFocusedDate=new Date(D)};sap.ui.unified.Calendar.prototype.focusDate=function(D){if(D&&(!this._oFocusedDate||this._oFocusedDate.getTime()!=D.getTime())){if(!(D instanceof Date)){throw new Error("Date must be a JavaScript date object; "+this)}var y=D.getFullYear();if(y<1||y>9999){throw new Error("Date must not be in valid range (between 0001-01-01 and 9999-12-31); "+this)}this._setFocusedDate(g(D));if(this.getDomRef()&&this._iMode==0){var i=this;e(i)}}return this};sap.ui.unified.Calendar.prototype.setPopupMode=function(P){this._bPoupupMode=P};sap.ui.unified.Calendar.prototype._getLocaleData=function(){if(!this._oLocaleData){var L=this.getLocale();var i=new sap.ui.core.Locale(L);this._oLocaleData=sap.ui.core.LocaleData.getInstance(i)}return this._oLocaleData};sap.ui.unified.Calendar.prototype.onclick=function(E){if(E.isMarked("delayedMouseEvent")){return}var i=this;var F=this._getFocusedDate();if(jQuery.sap.containsOrEquals(this.getDomRef("next"),E.target)&&!this.$("next").attr("disabled")){switch(this._iMode){case 0:F.setUTCMonth(F.getUTCMonth()+1,1);e(i);break;case 1:F.setUTCFullYear(F.getUTCFullYear()+1);this.$("year").text(F.getUTCFullYear());t(i,F);break;case 2:q(i,true,this._oItemNavigation.getFocusedIndex());break}}else if(jQuery.sap.containsOrEquals(this.getDomRef("prev"),E.target)&&!this.$("prev").attr("disabled")){switch(this._iMode){case 0:F.setUTCDate(1);F.setUTCDate(F.getUTCDate()-1);e(i);break;case 1:F.setUTCFullYear(F.getUTCFullYear()-1);this.$("year").text(F.getUTCFullYear());t(i,F);break;case 2:q(i,false,this._oItemNavigation.getFocusedIndex());break}}else if(E.target.id==this.getId()+"-month"){if(this._iMode!=1){k(i)}else{l(i)}this.addDelegate(this._oItemNavigation)}else if(E.target.id==this.getId()+"-year"){if(this._iMode!=2){n(i)}else{o(i)}this.addDelegate(this._oItemNavigation)}else if(E.target.id==this.getId()+"-cancel"){this.onsapescape(E)}};sap.ui.unified.Calendar.prototype._handleMouseMove=function(E){if(!this.$().is(":visible")){jQuery(window.document).unbind('mousemove',this._mouseMoveProxy);this._bMouseMove=undefined}var T=jQuery(E.target);if(T.hasClass("sapUiCalDayNum")){T=T.parent()}if(T.hasClass("sapUiCalDay")){var F=this._getFocusedDate();var O=F;F=this._oFormatYyyymmdd.parse(T.attr("data-sap-day"),true);this._setFocusedDate(F);if(F.getTime()!=O.getTime()){var i=this;if(T.hasClass("sapUiCalDayOtherMonth")){e(i)}else{h(i,F,false,true);this._bMoveChange=true}}}};sap.ui.unified.Calendar.prototype.onmouseup=function(E){if(this._bMouseMove){jQuery(window.document).unbind('mousemove',this._mouseMoveProxy);this._bMouseMove=undefined;var F=this._getFocusedDate();var D=this.$("days").children(".sapUiCalDay");for(var i=0;i<D.length;i++){var $=jQuery(D[i]);if(!$.hasClass("sapUiCalDayOtherMonth")){if($.attr("data-sap-day")==this._oFormatYyyymmdd.format(F,true)){$.focus();break}}}if(this._bMoveChange){var v=this;h(v,F);this._bMoveChange=false;s(v)}}};sap.ui.unified.Calendar.prototype.onsapselect=function(E){var i=this;var I=0;switch(this._iMode){case 0:if(jQuery.sap.containsOrEquals(this.getDomRef("days"),E.target)){h(i,i._getFocusedDate());s(i);E.stopPropagation();E.preventDefault()}break;case 1:if(jQuery.sap.containsOrEquals(this.getDomRef("months"),E.target)){I=this._oItemNavigation.getFocusedIndex();m(i,I)}break;case 2:if(jQuery.sap.containsOrEquals(this.getDomRef("years"),E.target)){I=this._oItemNavigation.getFocusedIndex();p(i,I)}break}};sap.ui.unified.Calendar.prototype.onsapselectmodifiers=function(E){this.onsapselect(E)};sap.ui.unified.Calendar.prototype.onsapescape=function(E){var i=this;switch(this._iMode){case 0:this.fireCancel();break;case 1:l(i);break;case 2:o(i);break}};sap.ui.unified.Calendar.prototype.onsapshow=function(E){if(this._bPoupupMode){var i=this;switch(this._iMode){case 1:l(i);break;case 2:o(i);break}this.fireCancel();E.preventDefault()}};sap.ui.unified.Calendar.prototype.onsaphide=sap.ui.unified.Calendar.prototype.onsapshow;sap.ui.unified.Calendar.prototype.onsappageupmodifiers=function(E){if(jQuery.sap.containsOrEquals(this.getDomRef("days"),E.target)){var F=this._getFocusedDate();var i=this;var y=F.getUTCFullYear();if(E.metaKey||E.ctrlKey){F.setUTCFullYear(y-10)}else{F.setUTCFullYear(y-1)}if(F.getTime()<this._oMinDate.getTime()){this._setFocusedDate(this._oMinDate)}e(i)}E.preventDefault()};sap.ui.unified.Calendar.prototype.onsappagedownmodifiers=function(E){if(jQuery.sap.containsOrEquals(this.getDomRef("days"),E.target)){var F=this._getFocusedDate();var i=this;var y=F.getUTCFullYear();if(E.metaKey||E.ctrlKey){F.setUTCFullYear(y+10)}else{F.setUTCFullYear(y+1)}if(F.getTime()>this._oMaxDate.getTime()){this._setFocusedDate(this._oMaxDate)}e(i)}E.preventDefault()};sap.ui.unified.Calendar.prototype.onsappageup=function(E){if(E.target.id==this.getId()+"-month"||E.target.id==this.getId()+"-year"){E.preventDefault()}};sap.ui.unified.Calendar.prototype.onsappagedown=sap.ui.unified.Calendar.prototype.onsappageup;sap.ui.unified.Calendar.prototype.onsaptabnext=function(E){if(jQuery.sap.containsOrEquals(this.getDomRef("days"),E.target)||jQuery.sap.containsOrEquals(this.getDomRef("months"),E.target)||jQuery.sap.containsOrEquals(this.getDomRef("years"),E.target)){jQuery.sap.focus(this.getDomRef("month"));if(!this._bPoupupMode){jQuery(this._oItemNavigation.getItemDomRefs()[this._oItemNavigation.getFocusedIndex()]).attr("tabindex","-1")}this.removeDelegate(this._oItemNavigation);E.preventDefault()}else if(E.target.id==this.getId()+"-month"){jQuery.sap.focus(this.getDomRef("year"));this.removeDelegate(this._oItemNavigation);E.preventDefault()}else if(E.target.id==this.getId()+"-year"){this.addDelegate(this._oItemNavigation)}};sap.ui.unified.Calendar.prototype.onsaptabprevious=function(E){if(jQuery.sap.containsOrEquals(this.getDomRef("days"),E.target)||jQuery.sap.containsOrEquals(this.getDomRef("months"),E.target)||jQuery.sap.containsOrEquals(this.getDomRef("years"),E.target)){if(this._bPoupupMode){jQuery.sap.focus(this.getDomRef("year"));this.removeDelegate(this._oItemNavigation);E.preventDefault()}}else if(E.target.id==this.getId()+"-month"){this.addDelegate(this._oItemNavigation);this._oItemNavigation.focusItem(this._oItemNavigation.getFocusedIndex());E.preventDefault()}else if(E.target.id==this.getId()+"-year"){jQuery.sap.focus(this.getDomRef("month"));E.preventDefault()}};sap.ui.unified.Calendar.prototype.onsapnext=function(E){if(E.target.id==this.getId()+"-month"||E.target.id==this.getId()+"-year"){E.preventDefault()}};sap.ui.unified.Calendar.prototype.onsapprevious=sap.ui.unified.Calendar.prototype.onsapnext;sap.ui.unified.Calendar.prototype.onfocusin=function(E){if(E.target.id==this.getId()+"-end"){jQuery.sap.focus(this.getDomRef("year"));jQuery(this._oItemNavigation.getItemDomRefs()[this._oItemNavigation.getFocusedIndex()]).attr("tabindex","-1");this.removeDelegate(this._oItemNavigation)}jQuery.sap.byId(this.getId()+"-end").attr("tabindex","-1")};sap.ui.unified.Calendar.prototype.onsapfocusleave=function(E){if(!E.relatedControlId||!jQuery.sap.containsOrEquals(this.getDomRef(),sap.ui.getCore().byId(E.relatedControlId).getFocusDomRef())){jQuery.sap.byId(this.getId()+"-end").attr("tabindex","0");this.addDelegate(this._oItemNavigation)}};sap.ui.unified.Calendar.prototype._checkDateSelected=function(D){if(!(D instanceof Date)){throw new Error("Date must be a JavaScript date object; "+this)}var S=0;var v=this.getSelectedDates();var T=D.getTime();for(var i=0;i<v.length;i++){var R=v[i];var w=g(R.getStartDate());var x;var y=0;if(w){x=w;y=x.getTime()}var E;var z=0;if(this.getIntervalSelection()){w=g(R.getEndDate());if(w){E=w;z=E.getTime()}}if(T==y&&!E){S=1;break}else if(T==y&&E){S=2;if(E&&T==z){S=5}break}else if(E&&T==z){S=3;break}else if(E&&T>y&&T<z){S=4;break}if(this.getSingleSelection()){break}}return S};sap.ui.unified.Calendar.prototype._getDateType=function(D){if(!(D instanceof Date)){throw new Error("Date must be a JavaScript date object; "+this)}var T;var S=this.getSpecialDates();var v=D.getTime();for(var i=0;i<S.length;i++){var R=S[i];var w=g(R.getStartDate());var x;var y=0;if(w){x=w;y=x.getTime()}var E;var z=0;w=g(R.getEndDate());if(w){E=w;z=E.getTime()}if((v==y&&!E)||(v>=y&&v<=z)){T={type:R.getType(),tooltip:R.getTooltip_AsString()};break}}return T};function _(C){var I=C.getParameter("index");var E=C.getParameter("event");if(!E){return}var v=this;var F=this._getFocusedDate();if(this._iMode==0){var D=this.$("days").children(".sapUiCalDay");var i=0;var $=jQuery(D[I]);var w;if($.hasClass("sapUiCalDayOtherMonth")){if(E.type=="saphomemodifiers"&&(E.metaKey||E.ctrlKey)){F.setUTCDate(1);u(v,F)}else if(E.type=="sapendmodifiers"&&(E.metaKey||E.ctrlKey)){for(i=D.length-1;i>0;i--){w=jQuery(D[i]);if(!w.hasClass("sapUiCalDayOtherMonth")){F=this._oFormatYyyymmdd.parse(w.attr("data-sap-day"),true);this._setFocusedDate(F);break}}if(F.getTime()>=this._oMinDate.getTime()&&F.getTime()<=this._oMaxDate.getTime()){this._oItemNavigation.focusItem(i)}else{u(v,F)}}else{F=this._oFormatYyyymmdd.parse($.attr("data-sap-day"),true);if(!F){F=this._getFocusedDate()}if(F.getTime()>=this._oMinDate.getTime()&&F.getTime()<=this._oMaxDate.getTime()){this._setFocusedDate(F);e(v)}else{u(v,F)}}}else{if(!jQuery(E.target).hasClass("sapUiCalWeekNum")){F=this._oFormatYyyymmdd.parse($.attr("data-sap-day"),true);if(F.getTime()>=this._oMinDate.getTime()&&F.getTime()<=this._oMaxDate.getTime()){this._setFocusedDate(F)}else{u(v,F)}}}}if(E.type=="mousedown"){b(v,E,F,I)}}function a(C){var i=C.getParameter("index");var E=C.getParameter("event");if(!E){return}if(E.type=="mousedown"){var v=this;var F=this._getFocusedDate();b(v,E,F,i)}}function b(T,E,F,i){switch(T._iMode){case 0:h(T,F,E.shiftKey);s(T);if(T.getIntervalSelection()&&T.$().is(":visible")){jQuery(window.document).bind('mousemove',T._mouseMoveProxy);T._bMouseMove=true}break;case 1:m(T,i);break;case 2:p(T,i);break}E.preventDefault();E.setMark("cancelAutoClose")}function c(C){var E=C.getParameter("event");var M=0;var F=this._getFocusedDate();if(E.type){var i=this;switch(this._iMode){case 0:switch(E.type){case"sapnext":case"sapnextmodifiers":if(E.keyCode==jQuery.sap.KeyCodes.ARROW_DOWN){F.setUTCDate(F.getUTCDate()+7)}else{F.setUTCDate(F.getUTCDate()+1)}break;case"sapprevious":case"sappreviousmodifiers":if(E.keyCode==jQuery.sap.KeyCodes.ARROW_UP){F.setUTCDate(F.getUTCDate()-7)}else{F.setUTCDate(F.getUTCDate()-1)}break;case"sappagedown":M=F.getUTCMonth()+1;F.setUTCMonth(M);if(M%12!=F.getUTCMonth()){while(M!=F.getUTCMonth()){F.setUTCDate(F.getUTCDate()-1)}}break;case"sappageup":M=F.getUTCMonth()-1;F.setUTCMonth(M);if(M<0){M=11}if(M!=F.getUTCMonth()){while(M!=F.getUTCMonth()){F.setUTCDate(F.getUTCDate()-1)}}break;default:break}if(F.getTime()>this._oMaxDate.getTime()){F.setUTCFullYear(this._oMaxDate.getUTCFullYear());F.setUTCMonth(this._oMaxDate.getUTCMonth());F.setUTCDate(this._oMaxDate.getUTCDate())}if(F.getTime()<this._oMinDate.getTime()){F.setUTCFullYear(this._oMinDate.getUTCFullYear());F.setUTCMonth(this._oMinDate.getUTCMonth());F.setUTCDate(this._oMinDate.getUTCDate())}e(i);break;case 1:break;case 2:switch(E.type){case"sapnext":case"sapnextmodifiers":if(E.keyCode==jQuery.sap.KeyCodes.ARROW_DOWN){q(i,true,this._oItemNavigation.getFocusedIndex()-16)}else{q(i,true,0)}break;case"sapprevious":case"sappreviousmodifiers":if(E.keyCode==jQuery.sap.KeyCodes.ARROW_UP){q(i,false,16+this._oItemNavigation.getFocusedIndex())}else{q(i,false,19)}break;case"sappagedown":q(i,true,this._oItemNavigation.getFocusedIndex());break;case"sappageup":q(i,false,this._oItemNavigation.getFocusedIndex());break;default:break}break}}}function d(T){var D=T._getFocusedDate();var y=T._oFormatYyyymmdd.format(D,true);var v=[];var R;var I=0;var C=0;var N=false;var w=true;switch(T._iMode){case 0:R=T.$("days").get(0);v=T.$("days").children(".sapUiCalDay");for(var i=0;i<v.length;i++){var $=jQuery(v[i]);if($.attr("data-sap-day")===y){I=i}}C=7;N=true;w=false;break;case 1:R=T.$("months").get(0);v=T.$("months").children(".sapUiCalMonth");I=D.getUTCMonth();C=3;break;case 2:R=T.$("years").get(0);v=T.$("years").children(".sapUiCalYear");I=10;C=4;N=true;w=false;break}if(!T._oItemNavigation){T._oItemNavigation=new sap.ui.core.delegate.ItemNavigation();T._oItemNavigation.attachEvent(sap.ui.core.delegate.ItemNavigation.Events.AfterFocus,_,T);T._oItemNavigation.attachEvent(sap.ui.core.delegate.ItemNavigation.Events.FocusAgain,a,T);T._oItemNavigation.attachEvent(sap.ui.core.delegate.ItemNavigation.Events.BorderReached,c,T);T.addDelegate(T._oItemNavigation);T._oItemNavigation.setHomeEndColumnMode(true,true);T._oItemNavigation.setDisabledModifiers({sapnext:["alt"],sapprevious:["alt"],saphome:["alt"],sapend:["alt"]})}T._oItemNavigation.setRootDomRef(R);T._oItemNavigation.setItemDomRefs(v);T._oItemNavigation.setCycling(w);T._oItemNavigation.setColumns(C,N);T._oItemNavigation.setFocusedIndex(I);T._oItemNavigation.setPageSize(v.length)}function e(T){this._sRenderMonth=undefined;var D=T._getFocusedDate();var C=T.$("days");if(C.length>0){var R=sap.ui.getCore().createRenderManager();T.getRenderer().renderDays(R,T,D);R.flush(C[0]);R.destroy()}T.fireEvent("_renderMonth",{days:C.children(".sapUiCalDay").length});var M=[];if(T._bLongMonth||!T._bNamesLengthChecked){M=T._getLocaleData().getMonthsStandAlone("wide")}else{M=T._getLocaleData().getMonthsStandAlone("abbreviated")}T.$("month").text(M[D.getUTCMonth()]);T.$("year").text(D.getUTCFullYear());d(T);T._oItemNavigation.focusItem(T._oItemNavigation.getFocusedIndex());t(T,D,true)}function f(D){if(D){return new Date(D.getTime()+D.getTimezoneOffset()*60000)}}function g(D){if(D){var U=new Date(Date.UTC(D.getFullYear(),D.getMonth(),D.getDate()));if(D.getFullYear()<1000){U.setUTCFullYear(D.getFullYear())}return U}}function h(T,D,I,M){var S=T.getSelectedDates();var v;var w=T.$("days").children(".sapUiCalDay");var $;var y;var i=0;if(T.getSingleSelection()){var x;if(S.length>0){v=S[0];x=g(v.getStartDate())}else{v=new sap.ui.unified.DateRange();T.addAggregation("selectedDates",v,true)}if(T.getIntervalSelection()&&(!v.getEndDate()||M)&&x){var E;if(D.getTime()<x.getTime()){E=x;x=D;if(!M){v.setProperty("startDate",f(x),true);v.setProperty("endDate",f(E),true)}}else if(D.getTime()>=x.getTime()){E=D;if(!M){v.setProperty("endDate",f(E),true)}}var z;for(i=0;i<w.length;i++){$=jQuery(w[i]);z=T._oFormatYyyymmdd.parse($.attr("data-sap-day"),true);if(z.getTime()==x.getTime()){$.addClass("sapUiCalDaySelStart");$.addClass("sapUiCalDaySel");if(E&&z.getTime()==E.getTime()){$.addClass("sapUiCalDaySelEnd")}}else if(E&&z.getTime()>x.getTime()&&z.getTime()<E.getTime()){$.addClass("sapUiCalDaySel");$.addClass("sapUiCalDaySelBetween")}else if(E&&z.getTime()==E.getTime()){$.addClass("sapUiCalDaySelEnd");$.addClass("sapUiCalDaySel")}else{if($.hasClass("sapUiCalDaySel")){$.removeClass("sapUiCalDaySel")}if($.hasClass("sapUiCalDaySelStart")){$.removeClass("sapUiCalDaySelStart")}else if($.hasClass("sapUiCalDaySelBetween")){$.removeClass("sapUiCalDaySelBetween")}else if($.hasClass("sapUiCalDaySelEnd")){$.removeClass("sapUiCalDaySelEnd")}}}}else{y=T._oFormatYyyymmdd.format(D,true);for(i=0;i<w.length;i++){$=jQuery(w[i]);if(!$.hasClass("sapUiCalDayOtherMonth")&&$.attr("data-sap-day")==y){$.addClass("sapUiCalDaySel")}else if($.hasClass("sapUiCalDaySel")){$.removeClass("sapUiCalDaySel")}if($.hasClass("sapUiCalDaySelStart")){$.removeClass("sapUiCalDaySelStart")}else if($.hasClass("sapUiCalDaySelBetween")){$.removeClass("sapUiCalDaySelBetween")}else if($.hasClass("sapUiCalDaySelEnd")){$.removeClass("sapUiCalDaySelEnd")}}v.setProperty("startDate",f(D),true);v.setProperty("endDate",undefined,true)}}else{if(T.getIntervalSelection()){throw new Error("Calender don't support multiple interval selection")}else{var A=T._checkDateSelected(D);if(A>0){for(i=0;i<S.length;i++){if(S[i].getStartDate()&&D.getTime()==g(S[i].getStartDate()).getTime()){T.removeAggregation("selectedDates",i,true);break}}}else{v=new sap.ui.unified.DateRange({startDate:f(D)});T.addAggregation("selectedDates",v,true)}y=T._oFormatYyyymmdd.format(D,true);for(i=0;i<w.length;i++){$=jQuery(w[i]);if(!$.hasClass("sapUiCalDayOtherMonth")&&$.attr("data-sap-day")==y){if(A>0){$.removeClass("sapUiCalDaySel")}else{$.addClass("sapUiCalDaySel")}}}}}}function j(T){var S=T.getSelectedDates();if(S&&S[0]&&S[0].getStartDate()){T._oFocusedDate=g(S[0].getStartDate())}else{var i=new Date();T._oFocusedDate=g(i)}}function k(T){if(T._iMode==2){o(T)}var D=T._getFocusedDate();var R=sap.ui.getCore().createRenderManager();var C=T.$();T.getRenderer().renderMonthPicker(R,T,D);R.flush(C[0],false,true);R.destroy();T._iMode=1;jQuery(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()]).attr("tabindex","-1");d(T);jQuery.sap.focus(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()]);t(T,D,false)}function l(T){T.$("months").remove();T._iMode=0;d(T);jQuery.sap.focus(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()]);var F=T._getFocusedDate();T.$("year").text(F.getUTCFullYear());t(T,F,true)}function m(T,M){var F=T._getFocusedDate();F.setUTCMonth(M);if(M!=F.getUTCMonth()){F.setUTCDate(0)}if(F.getTime()<T._oMinDate.getTime()){T._setFocusedDate(T._oMinDate)}else if(F.getTime()>T._oMaxDate.getTime()){T._setFocusedDate(T._oMaxDate)}e(T);l(T)}function n(T){if(T._iMode==1){l(T)}var D=T._getFocusedDate();var R=sap.ui.getCore().createRenderManager();var C=T.$();var y=T._oMaxDate.getUTCFullYear();var Y=T._oMinDate.getUTCFullYear();if(y-Y<=20){return}if(D.getUTCFullYear()>(y-10)){D.setUTCFullYear(y-9);T.$("next").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("next").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}if(D.getUTCFullYear()<(Y+9)){D.setUTCFullYear(Y+10);T.$("prev").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("prev").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}T.getRenderer().renderYearPicker(R,T,D);R.flush(C[0],false,true);R.destroy();var i=T.$("days").children(".sapUiCalDay");if(i.length==28){T.$("years").addClass("sapUiCalYearNoTop")}T._iMode=2;jQuery(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()]).attr("tabindex","-1");d(T);jQuery.sap.focus(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()])}function o(T){T.$("years").remove();T._iMode=0;d(T);jQuery.sap.focus(T._oItemNavigation.getItemDomRefs()[T._oItemNavigation.getFocusedIndex()]);var F=T._getFocusedDate();t(T,F,true)}function p(T,i){var F=T._getFocusedDate();var D=T.$("years").children(".sapUiCalYear");var y=jQuery(D[i]).text();F.setUTCFullYear(y);if(F.getTime()<T._oMinDate.getTime()){T._setFocusedDate(T._oMinDate)}else if(F.getTime()>T._oMaxDate.getTime()){T._setFocusedDate(T._oMaxDate)}e(T);o(T)}function q(T,F,S){var D=T.$("years").children(".sapUiCalYear");var v=parseInt(jQuery(D[0]).text());var w=T._getFocusedDate();var C=w.getUTCFullYear().toString();var y=T._oMaxDate.getUTCFullYear();var Y=T._oMinDate.getUTCFullYear();if(F){v=v+20}else{v=v-20}if(v>=y-19){v=y-19;T.$("next").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("next").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}if(v<=Y){v=Y;T.$("prev").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("prev").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}var x=v;for(var i=0;i<D.length;i++){var $=jQuery(D[i]);$.attr("id",T.getId()+"-y"+x);$.text(x);if($.hasClass("sapUiCalYearSel")&&$.text()!=C){$.removeClass("sapUiCalYearSel")}else if(!$.hasClass("sapUiCalYearSel")&&$.text()==C){$.addClass("sapUiCalYearSel")}x++}T._oItemNavigation.focusItem(S)}function r(T){if(!T._bNamesLengthChecked){var i=0;var w;var L;var W=T.$().children(".sapUiCalWH");var v=false;for(i=0;i<W.length;i++){w=W[i];if(w.clientWidth<w.scrollWidth){v=true;break}}if(v){T._bLongWeekDays=false;L=T._getLocaleData();var F=L.getFirstDayOfWeek();var D=L.getDaysStandAlone("narrow");for(i=0;i<D.length;i++){w=W[i];jQuery(w).text(D[(i+F)%7])}}else{T._bLongWeekDays=true}k(T);var M=T.$("months").children();v=false;for(i=0;i<M.length;i++){var x=M[i];if(x.clientWidth<x.scrollWidth){v=true;break}}if(v){T._bLongMonth=false;if(!L){L=T._getLocaleData()}var y=L.getMonthsStandAlone("abbreviated");var z=T._getFocusedDate();T.$("month").text(y[z.getUTCMonth()])}else{T._bLongMonth=true}l(T);T._bNamesLengthChecked=true}}function s(T){if(T._bMouseMove){jQuery(window.document).unbind('mousemove',T._mouseMoveProxy);T._bMouseMove=undefined}T.fireSelect()}function t(T,D,C){var y=D.getUTCFullYear();var Y=T._oMaxDate.getUTCFullYear();var i=T._oMinDate.getUTCFullYear();var M=D.getUTCMonth();var v=T._oMaxDate.getUTCMonth();var w=T._oMinDate.getUTCMonth();if(y>Y||(y==Y&&(!C||M>=v))){T.$("next").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("next").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}if(y<i||(y==i&&(!C||M<=w))){T.$("prev").toggleClass("sapUiCalDsbl",true).attr("disabled","disabled")}else{T.$("prev").toggleClass("sapUiCalDsbl",false).removeAttr("disabled")}}function u(T,D){var F;if(D.getTime()<T._oMinDate.getTime()){F=T._oMinDate}else if(D.getTime()>T._oMaxDate.getTime()){F=T._oMaxDate}else{F=D}T._setFocusedDate(F);var y=T._oFormatYyyymmdd.format(F,true);var v=T._oItemNavigation.getItemDomRefs();var $;for(var i=0;i<v.length;i++){$=jQuery(v[i]);if($.attr("data-sap-day")==y){T._oItemNavigation.focusItem(i);break}}}}());
