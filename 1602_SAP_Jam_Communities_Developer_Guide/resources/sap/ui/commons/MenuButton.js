/*!
 * SAP UI development toolkit for HTML5 (SAPUI5/OpenUI5)
 * (c) Copyright 2009-2014 SAP SE or an SAP affiliate company. 
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare("sap.ui.commons.MenuButton");jQuery.sap.require("sap.ui.commons.library");jQuery.sap.require("sap.ui.commons.Button");sap.ui.commons.Button.extend("sap.ui.commons.MenuButton",{metadata:{library:"sap.ui.commons",properties:{"dockButton":{type:"string",group:"Misc",defaultValue:null},"dockMenu":{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"menu",aggregations:{"menu":{type:"sap.ui.unified.Menu",multiple:false}},events:{"itemSelected":{}}}});sap.ui.commons.MenuButton.M_EVENTS={'itemSelected':'itemSelected'};jQuery.sap.require("sap.ui.commons.MenuItemBase");jQuery.sap.require("sap.ui.commons.Menu");(function(){sap.ui.commons.MenuButton.prototype.init=function(){this.addStyleClass("sapUiMenuButton");this.bWithKeyboard=false};sap.ui.commons.MenuButton.prototype.onclick=function(e){if(this.getEnabled()&&!this._bSkipOpen){var t=this.getTooltip();if(t&&t instanceof sap.ui.core.TooltipBase){t._closeOrPreventOpen()}var d=this.getDockButton()?this.getDockButton():sap.ui.core.Popup.Dock.BeginBottom;var D=this.getDockMenu()?this.getDockMenu():sap.ui.core.Popup.Dock.BeginTop;this.getMenu().open(this.bWithKeyboard,this,D,d,this)}this.bWithKeyboard=false;this._bSkipOpen=false;e.preventDefault();e.stopPropagation()};sap.ui.commons.MenuButton.prototype.onmousedown=function(e){this.handleMouseDown(e,false);this._bSkipOpen=this.getMenu()&&this.getMenu().bOpen};sap.ui.commons.MenuButton.prototype.onmouseout=function(e){if(sap.ui.commons.Button.prototype.onmouseout){sap.ui.commons.Button.prototype.onmouseout.apply(this,arguments)}if(this._bSkipOpen&&jQuery.sap.checkMouseEnterOrLeave(e,this.getDomRef())){this._bSkipOpen=false}};sap.ui.commons.MenuButton.prototype.onsapenter=function(e){this.bWithKeyboard=true};sap.ui.commons.MenuButton.prototype.onsapspace=function(e){this.bWithKeyboard=true};sap.ui.commons.MenuButton.prototype.onsapdownmodifiers=function(e){if(e.altKey){this.bWithKeyboard=true;this.onclick(e)}};sap.ui.commons.MenuButton.prototype.clone=function(i,l){u(this);var c=sap.ui.commons.Button.prototype.clone.apply(this,arguments);u(this,this.getMenu());return c};sap.ui.commons.MenuButton.prototype.setMenu=function(m){u(this,m);this.setAggregation("menu",m);return this};sap.ui.commons.MenuButton.prototype.destroyMenu=function(){u(this,null);this.destroyAggregation("menu");return this};var u=function(t,n){var m=t.getMenu();if(m){m.detachItemSelect(t._fItemSelectHandler)}t._fItemSelectHandler=jQuery.proxy(o,t);if(n){n.attachItemSelect(t._fItemSelectHandler)}};var o=function(e){var i=e.getParameter("item");this.fireItemSelected({itemId:i.getId(),item:i});this.firePress({itemId:i.getId(),item:i})}}());
